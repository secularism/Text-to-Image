# PROGRESSIVE GROWING OF GANS FOR IMPROVED QUALITY, STABILITY, AND VARIATION

## 作者：Tero Karras、Timo Aila、Samuli Laine、Jaakko Lehtinen 时间：2018

## 会议：ICLR 

## 前言：

* 该文是一种针对GANs的训练优化方法，从低分辨率图像开始，通过向网络添加层来逐步提高分辨率。这种递增的特性允许训练首先发现图像分布的大尺度结构，然后将注意力转移到越来越细的尺度细节上，而不必同时学习所有的尺度。![在这里插入图片描述](D:\workplace\note\数字水印论文\笔记\2月份\1月31号-2月6号\PROGRESSIVE GROWING OF GANS FOR IMPROVED QUALITY, STABILITY, AND VARIATION_img\20200923212010440.png)
* 刚开始训练的时候，生成器和鉴别器的空间分辨率都很低，如图中4x4像素。随着训练的进行，我们逐渐在两个网络上增加层，从而提高生成图片的分辨率。在整个过程中，所有层都是可训练的。这里的NxN是指在N x N空间分辨率下的卷积层。这允许在高分辨率下稳定的拟合，也能极大地加快训练速度

## 网络模型

* 该文提出的生成器和鉴别器的结构它们彼此相反，在整个训练过程中，两个网络中的所有层在训练阶段都是可训练的。当新层被添加到网络中时，我们平滑地淡出现有网络。![在这里插入图片描述](D:\workplace\note\数字水印论文\笔记\2月份\1月31号-2月6号\PROGRESSIVE GROWING OF GANS FOR IMPROVED QUALITY, STABILITY, AND VARIATION_img\20200926223447962.png)
* 作者提出：当加倍生成器和鉴别器的分辨率时，我们“平滑”地添加新图层。该例子说明了从16×16图像(a)到32×32图像(c)的转换过程。在转换(b)过程中，我们将操作在更高分辨率上的层类似残差块一样处理，其权重α从0到1线性增加。这里2x和0.5x分别表示使用最邻近邻滤波和平均池化将图像分辨率加倍和减半。toRGB表示将特征向量投影到RGB颜色层，fromRGB做相反操作; 都使用1 x 1卷积。在训练鉴别器时，我们输入经过缩小的真实图像，以匹配当前网络的分辨率。在分辨率转换期间，类似于生成器输出组合两种分辨率的方式，我们在真实图像的两种分辨率之间插入。

## 渐进式训练的好处：

* 在早期，由于类别信息和模式较少，生成更小图像基本上更稳定：通过一点点地提高分辨率，通过重复一个简化问题，而非直接解决从隐向量直接找到1024<sup>2</sup>的图像。实际上，他稳定了训练，使我们能够使用WGAN-GP或者LSGANs损失可靠地合成百万像素级的图像。
* 另一个好处是减少了训练时间。随着GANs的不断增长，大多数迭代都是在较低的分辨率下完成的，根据最终的输出分辨率，获得可比的结果质量通常要快2-6倍。

##  INCREASING VARIATION USING MINIBATCH STANDARD DEVIATION（基于 ‘批标准差’ 增加多样性）

* 由于GAN网络倾向于学习数据集的子部分，由此有人提出minibatch discrimination作为解决方案。它们不仅从单个图像中计算特征统计数据，也从整个minibatch中计算特征统计数据，从而激励生成图像和训练图像的minibatch显示类似的统计数据或分布。
  * 这是通过在鉴别器的末尾添加一个minibatch层来实现的，该层将学习一个大型张量，且该张量将输入量激活并映射到一组统计数组中。在一个minibatch中，为每个示例生成一组单独的统计信息组，并将其拼接到层的输出，以便鉴别器可以在内部使用统计信息。作者大大简化了这种方法，同时也改进了多样性。
  * 在简化方案中既没有可学习参数也没有新的超参数。首先计算每个minibatch空间位置上每个特征图的标准差。然后将这些估计值平均到所有特征图和空间位置，得到单一值。复制扩张该值，将其连接到所有空间位置，并覆盖整个minibatch，从而产生一个额外的(常量)特征图。

## NORMALIZATION IN GENERATOR AND DISCRIMINATOR（归一化处理生成器和鉴别器）

* 由于两个网络之间的不健康竞争，网络间的信号强度容易增加。大多数早期的解决方案通过使用批处理标准化的变体来阻止这种情况的发生在生成器中，也经常在鉴别器中，这些归一化方法最初是为了消除协变量位移而引入的。

## EQUALIZED LEARNING RATE（平衡学习率）

## PIXELWISE FEATURE VECTOR NORMALIZATION IN GENERATOR（生成器像素的归一化）

## PROGRESSIVE NETWORK（构造渐增型网络）